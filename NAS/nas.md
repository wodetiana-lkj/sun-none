# 成品nas

群晖Synology 、威联通QNAP

# 自组NAS

##  nas系统选择

1. openmediavault
2. freeNas
3. Unraid
4. 黑群晖Synology

在选择NAS系统的时候，需要考虑到你对NAS的定位

选择openmediavault的原因

1. 更纯粹的linux的系统，原生的docker支持
2. 界面简洁，上手简单
3. 插件化管理，对于需求的增强功能直接安装插件，但是相对的学习成本也会提高(这里举例FreeNAS的ZFS文件系统)
4. 不希望被硬件限制(黑群晖有硬件限制)

对于另外三个系统简单差异：

- FreeNAS拥有ZFS文件系统进行管理，存储文件节省空间，中文适配部分有歧义，通过Jail方式隔离环境(类docker)
- Unraid优势在于不需要手动的对磁盘做软raid也就意味着不需要考虑到后续硬盘添加的问题，但是它的问题同样也在于no raid ，写入速度没办法达到和系统软raid相同甚至与比单盘写入速度更慢，另外这是个付费系统
- 群晖Synology是上手简单，可视化优良且拥有群晖公司附带的软件，综合考虑最优秀的系统，因此衍生而出黑群晖，但是黑群晖系统对硬件有限制所以PASS

## 硬件选择

硬件的选择是没办法脱离操作系统的选择的

这里只能站在openmediavault的角度去考虑比较其他NAS系统选择硬件

> 内存

使用Unraid和FreeNAS都对内存有较高要求，一般建议16G(FreeNAS官方建议)

> CPU

首先的考虑是J1900和J3455，以上两种属于工控机主板，功耗低，板载CPU、显卡降低成本，有千兆网口，性能做NAS存储完全够用

但是如果有AIO(All In One)需求的时候，往往会考虑到需要HTPC(Home Theater Personal Computer)，这就需要考虑到CPU的解码问题

1. CPU软解：仅需要考虑CPU的频率，核显的有无并不需要关心，购买没有核显的CPU也可以进一步降低成本，可以购买亮机卡装系统后，通过远程连接操作机器
2. 核显硬解：需要考虑到核显(不在乎成本和电费可以直接独显)的性能以及解码能力，下面给出intel对应的解码

![intel cpu解码支持](..\images\intel_cpu_decode.jpg)

> 主板

主板的考虑适配和扩展，适配即和CPU、内存的匹配，扩展即PCIE插槽和SATA接口的数量

此处不对匹配性进行描述

PCIE转接扩展SATA口和原生SATA口区别在于非原生SATA接口硬盘SMART信息读取部分会出现问题无法监控硬盘信息

## 个人选择

机箱、电源为自主选择，本人机箱电源随缘挑选，怎么便宜怎么来

> 第一套

| 硬件类型 |        型号         |
| :------: | :-----------------: |
|   CPU    |      工控主板       |
|   主板   |   七彩虹战斧J1900   |
|   内存   | 威刚DDR3 1600MHz 4G |
|   硬盘   |  2 * 1TB 西数蓝盘   |
| 系统硬盘 |    光威120G固态     |

主板J1900 参数要求内存1333MHz ，尽量上1600MHz内存，不然会有启动问题，仅个人问题，不知道是否都会出现

初试NAS，硬盘直接咸鱼(考虑学习问题，并不考虑大容量，主要在体验。如果生产并不建议咸鱼购买，硬盘有价，数据无价)

系统硬盘单独使用SATA固态，相对于U盘启停和写入以及使用体验上，固态占绝对优势，个人觉得系统硬盘上个固态绝对是有必要的

> 第二套

|  硬件类型  |        型号         |
| :--------: | :-----------------: |
|    CPU     |      i3 8100T       |
|    主板    |      微星B365       |
|    内存    | 2 * 宇瞻2666MHz 8G  |
|    硬盘    | 4 * 希捷ST4000VX003 |
|  系统硬盘  |      光威120G       |
| PCIE转SATA |    扩展SATA接口     |

相对于第一套来讲，明确了HTPC的需求后，更换了CPU和主板

1. CPU 核显解码能力提升
2. 主板SATA接口6个
3. 内存是旧主机替换下来冗余的内存条
4. 接触PT下载后，需要大量的空间储存影片资源，入手4块4T，均价100R/T，5900转噪声相对低，发热量相对较小，购买硬盘选择CMR(垂直盘)，不要选择SMR(叠瓦盘)。
5. 因为考虑到后期可能还会增加硬盘，所以购买单独的PCIE转接卡给SATA固态，留下原生接口冗余



# NAS学习路上的名词

> RAID

磁盘阵列技术

简单来说就是将多个物理硬盘合成为一个逻辑硬盘，并且通过磁盘阵列技术可以获得更高的读写速度



RAID目前分为硬RAID和软RAID，硬RAID即通过主板提供的RAID功能或者阵列卡实现RAID，软RAID则是交给操作系统实现，目前软RAID技术逐步完善更推荐使用软RAID

实现RAID技术后，当某块硬盘出现问题时，恢复数据自然而然也比单块硬盘更为困难，由此出现了不同的RAID冗余磁盘技术实现规范

- RAID0
- RAID1
- RAID5
- RAID10

这里根据不同的规范其实还有很多不同的实现标准，只做简介

openmediavault中，分成了条带、镜像、线性、RAID5、RAID6、RAID10

- 条带和线性做比较，线性即仅作为逻辑硬盘，顺序写入；条带则同RAID0，相对提高了读写速度；两种类型都是没有冗余磁盘的一旦出现磁盘损坏，几乎没有恢复可能
- 镜像 即 RAID1 数据安全性最高的冗余磁盘阵列方式，1块存储，1块备份，相当于放弃了一半的存储空间
- RAID5至少需要三块磁盘，将冗余数据分别存在各个磁盘，损坏一块直接更换
- RAID10，不应称呼为"RAID十"，应该是"RAID1 0"，=RAID1 + RAID0

